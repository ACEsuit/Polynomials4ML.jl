<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>- · Polynomials4ML.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://ACEsuit.github.io/Polynomials4ML.jl/SH/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Polynomials4ML.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../experimental/">Experimental</a></li><li><a class="tocitem" href="../docstrings/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>-</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>-</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ACEsuit/Polynomials4ML.jl/blob/main/docs/src/SH.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Spherical-Harmonics"><a class="docs-heading-anchor" href="#Spherical-Harmonics">Spherical Harmonics</a><a id="Spherical-Harmonics-1"></a><a class="docs-heading-anchor-permalink" href="#Spherical-Harmonics" title="Permalink"></a></h2><p>This section provides documentation for the evaluation of complex and real spherical harmonics and solid harmonics, including gradient and Laplacian calculations. </p><ul><li><a href="#associated-legendre-polynomials">Associated Legendre Polynomials</a></li><li><a href="#complex-spherical-harmonics">Complex Spherical Harmonics</a></li><li><a href="#complex-solid-harmonics">Complex Solid Harmonics</a></li><li><a href="#real-spherical-harmonics">Real Spherical Harmonics</a></li><li><a href="#real-solid-harmonics">Real Solid Harmonics</a></li></ul><h3 id="Associated-Legendre-Polynomials"><a class="docs-heading-anchor" href="#Associated-Legendre-Polynomials">Associated Legendre Polynomials</a><a id="Associated-Legendre-Polynomials-1"></a><a class="docs-heading-anchor-permalink" href="#Associated-Legendre-Polynomials" title="Permalink"></a></h3><p>Associated Legendre polynomials <span>$P_{\ell}^m$</span> are closely related to the spherical harmonics, <span>$P_{\ell}^m$</span> of degree <span>$\ell$</span> and order <span>$m\geq 0$</span> are defined as (in the phase convention of Condon and Shortley) $ \begin{aligned} P<em>{\ell}^m(x) = \frac{(-1)^m}{2^{\ell}\ell!}(1-x^2)^{m/2}\frac{\mathrm{d}^{\ell+m}}{\mathrm{d}x^{\ell+m}}(x^2-1)^{\ell}. \end{aligned} $ The negative order can be related to the corresponding positive order via a proportionality constant that involves only <span>$\ell$</span> and <span>$m$</span>,  $ \begin{aligned} P</em>{\ell}^{-m}(x) = (-1)^m \frac{(\ell-m)!}{(\ell+m)!}P<em>{\ell}^m(x).  \end{aligned} $ The associated Legendre polynomials are orthogonal on the interval <span>$-1\leq x\leq 1$</span> in the sense that  $ \begin{aligned} \int</em>{-1}^{1} P<em>{k}^m(x) P</em>{\ell}^m(x) \mathrm{d}x = \frac{2}{2\ell+1}\frac{(\ell+m)!}{(\ell-m)!}\delta_{k\ell}.  \end{aligned} $</p><p>In <code>alp.jl</code>, Polynomials4ML utilizes the following normalization for the associated Legendre polynomials,   $ \begin{aligned} \bar{P}<em>{\ell}^{m}(x) = \sqrt{\frac{(2\ell+1)(\ell-m)!}{2\pi (\ell+m)!}}P</em>{\ell}^m, \qquad m\geq 0 \end{aligned} $ and one can generate a data structure as </p><pre><code class="language-julia hljs">ALPs = ALPolynomials(maxL::Integer, T::Type=Float64)</code></pre><p>where <code>maxL</code> specifies the maximum degree of the polynomials. </p><p>The associated Legendre polynomials allow for </p><pre><code class="language-julia hljs">P = evaluate(basis, X)
P, dP = evaluate_ed(basis, X)</code></pre><p><code>X</code> is a point in spherical coordinates, <code>P</code> and <code>dp</code> stores <code>P_l^m(X.cosθ)</code> and <code>dP_l^m(X.cosθ)</code>. Specifically, only non-negative <code>m</code> terms are stored, and are arranged in <span>$\ell$</span>-major order. To retrieve the specific values of <code>P_l^m</code> and <code>dP_l^m</code> for given indices <code>(l, m)</code>, one can use</p><pre><code class="language-julia hljs">index_p(l,m)</code></pre><p>The algorithm for computing associated Legendre polynomials is based on Dusson(2022) eq.(A.7), where <code>A_l^m</code>, <code>B_l^m</code>, <code>C_l^m</code> can be found in Limpanuparb(2014) eq.(7)-(14). </p><h3 id="Condon-Shortley-Sign-Convention"><a class="docs-heading-anchor" href="#Condon-Shortley-Sign-Convention">Condon-Shortley Sign Convention</a><a id="Condon-Shortley-Sign-Convention-1"></a><a class="docs-heading-anchor-permalink" href="#Condon-Shortley-Sign-Convention" title="Permalink"></a></h3><p>There are two sign conventions for associated Legendre polynomials. </p><ul><li>Include the Condon-Shortley phase factor:</li></ul>$<p>\begin{aligned} P_{\ell}^m(x) = \frac{(-1)^m}{2^{\ell}\ell!}(1-x^2)^{m/2}\frac{\mathrm{d}^{\ell+m}}{\mathrm{d}x^{\ell+m}}(x^2-1)^{\ell}. \end{aligned} $</p><ul><li>Exclude the Condon-Shortley phase factor:</li></ul>$<p>\begin{aligned} P<em>{\ell}^m(x) = \frac{1}{2^{\ell}\ell!}(1-x^2)^{m/2}\frac{\mathrm{d}^{\ell+m}}{\mathrm{d}x^{\ell+m}}(x^2-1)^{\ell}. \end{aligned} $ One possible way to distinguish the two conventions is $ \begin{aligned} P</em>{\ell m}(x) = (-1)^m P_{\ell}^m(x).  \end{aligned} $</p><p>The Condon-Shortley sign convention enables us to establish the following relationships between spherical harmonics and angular momentum ladder operators $ \begin{aligned} Y<em>{\ell}^m(\theta, \varphi) &amp;= A</em>{\ell m}\hat{L}<em>-^{\ell-m}Y</em>{\ell}^{\ell}(\theta, \varphi), \
Y<em>{\ell}^m(\theta, \varphi) &amp;= A</em>{\ell, -m}\hat{L}<em>+^{\ell+m}Y</em>{\ell}^{-\ell}(\theta, \varphi),  \end{aligned} $ with all positive constants <span>$A_{\ell m} = \sqrt{\frac{(\ell+m)!}{(2\ell)!(\ell+m)!}}$</span>. Ignoring the Condon-Shortley phase would introduce signs into the <span>$A_{\ell m}$</span>. It&#39;s only a sign convention. </p><p>Including the factor of <span>$(-1)^m$</span> and written in terms <span>$x=\cos\theta$</span>,  the first few associated Legendre polynomials are  | <span>$m\backslash\ell$</span> | 0         | 1          | 2         | 3          | |–––––––––|–––––-|–––––-|–––––-|–––––-| | 3                |           |           |           | <span>$-15\sin^3\theta$</span> | | 2                |           |           | <span>$3\sin^2\theta$</span> | <span>$15\cos\theta\sin^2\theta$</span> | | 1                |           | <span>$-\sin\theta$</span> | <span>$-3\sin\theta\cos\theta$</span> | <span>$-\frac{3}{2}(5\cos^2\theta - 1)\sin\theta$</span> | | 0                | <span>$1$</span>         | <span>$\cos\theta$</span> | <span>$\frac{1}{2}(3\cos^2\theta - 1)$</span> | <span>$\frac{1}{2}\cos\theta(5\cos^2\theta-3)$</span> |</p><h3 id="Complex-Spherical-Harmonics"><a class="docs-heading-anchor" href="#Complex-Spherical-Harmonics">Complex Spherical Harmonics</a><a id="Complex-Spherical-Harmonics-1"></a><a class="docs-heading-anchor-permalink" href="#Complex-Spherical-Harmonics" title="Permalink"></a></h3><p>In <code>cylm.jl</code>, Polynomials4ML utilizes orthonormalized complex spherical harmonics that includes the Condon-Shortley phase, defined as $ \begin{aligned} 	Y<em>{\ell}^m(\theta, \varphi) = \sqrt{\frac{2\ell+1}{4\pi}\frac{(\ell-m)!}{(\ell+m)!}}P</em>{\ell}^m(\cos \theta)\mathrm{e}^{\mathrm{i}m \varphi}.  \end{aligned} $ The normalization in complex spherical harmonics is chosen to satisfy $ \begin{aligned} 	\int<em>0^{2\pi}\int</em>0^{\pi}Y<em>{k}^m(\theta, \varphi)\bar{Y}</em>{\ell}^n(\theta, \varphi)\sin \theta \mathrm{d}\theta\mathrm{d}\varphi =\delta<em>{k\ell}\delta</em>{mn}. \end{aligned} $ Orthonormalized complex spherical harmonics that include the Condon-Shortley phase up to degree <span>$\ell = 3$</span> are</p><table><tr><th style="text-align: right"><span>$m\backslash\ell$</span></th><th style="text-align: right">0</th><th style="text-align: right">1</th><th style="text-align: right">2</th><th style="text-align: right">3</th></tr><tr><td style="text-align: right">3</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><span>$-\frac{1}{8}\sqrt{\frac{35}{\pi}}\cdot \mathrm{e}^{3\mathrm{i}\varphi}\cdot \sin^3\theta$</span></td></tr><tr><td style="text-align: right">2</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{15}{2\pi}}\cdot \mathrm{e}^{2\mathrm{i}\varphi}\cdot \sin^2\theta$</span></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{105}{2\pi}}\cdot \mathrm{e}^{2\mathrm{i}\varphi}\cdot \sin^2\theta\cdot \cos\theta$</span></td></tr><tr><td style="text-align: right">1</td><td style="text-align: right"></td><td style="text-align: right"><span>$-\frac{1}{2}\sqrt{\frac{3}{2\pi}}\cdot \mathrm{e}^{\mathrm{i}\varphi}\cdot \sin\theta$</span></td><td style="text-align: right"><span>$-\frac{1}{2}\sqrt{\frac{15}{2\pi}}\cdot \mathrm{e}^{\mathrm{i}\varphi}\cdot \sin\theta \cdot \cos\theta$</span></td><td style="text-align: right"><span>$-\frac{1}{8}\sqrt{\frac{21}{\pi}}\cdot \mathrm{e}^{\mathrm{i}\varphi}\cdot \sin\theta \cdot (5\cos^2\theta-1)$</span></td></tr><tr><td style="text-align: right">0</td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{\frac{1}{\pi}}$</span></td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{\frac{3}{\pi}}\cdot \cos \theta$</span></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{5}{\pi}}\cdot (3\cos^2\theta - 1)$</span></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{7}{\pi}}\cdot (5\cos^3\theta - 3\cos\theta)$</span></td></tr><tr><td style="text-align: right">-1</td><td style="text-align: right"></td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{\frac{3}{2\pi}}\cdot \mathrm{e}^{-\mathrm{i}\varphi}\cdot \sin\theta$</span></td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{\frac{15}{2\pi}}\cdot \mathrm{e}^{-\mathrm{i}\varphi}\cdot \sin\theta \cdot \cos\theta$</span></td><td style="text-align: right"><span>$\frac{1}{8}\sqrt{\frac{21}{\pi}}\cdot \mathrm{e}^{-\mathrm{i}\varphi}\cdot \sin\theta \cdot (5\cos^2\theta-1)$</span></td></tr><tr><td style="text-align: right">-2</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{15}{2\pi}}\cdot \mathrm{e}^{-2\mathrm{i}\varphi}\cdot \sin^2\theta$</span></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{105}{2\pi}}\cdot \mathrm{e}^{-2\mathrm{i}\varphi}\cdot \sin^2\theta\cdot \cos\theta$</span></td></tr><tr><td style="text-align: right">-3</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><span>$\frac{1}{8}\sqrt{\frac{35}{\pi}}\cdot \mathrm{e}^{-3\mathrm{i}\varphi}\cdot \sin^3\theta$</span></td></tr></table><p>To generate the complex spherical harmonics <span>$Y_{\ell}^m$</span> with normalized associated Legendre polynomials <span>$\bar{P}_{\ell}^m$</span>, the formulas can be rewritten as $ \begin{aligned} \begin{cases} Y<em>{\ell}^0(\theta, \varphi) = \sqrt{\frac{1}{2}}\bar{P}</em>{\ell}^0(\cos \theta)\
Y<em>{\ell}^m(\theta, \varphi) = \sqrt{\frac{1}{2}}\bar{P}</em>{\ell}^m(\cos \theta)\mathrm{e}^{\mathrm{i}m \varphi}\
Y<em>{\ell}^{-m}(\theta, \varphi) = (-1)^m\cdot \sqrt{\frac{1}{2}} \bar{P}</em>{\ell}^m(\cos \theta)\mathrm{e}^{-\mathrm{i}m \varphi} \end{cases}, \qquad m&gt;0. \end{aligned} $ To evaluate the gradients of the spherical harmonics <span>$\nabla Y_{\ell}^m$</span>, one need to convert a gradient with respect to spherical coordinates to a gradient with respect to cartesian coordinates,  $ \begin{aligned} \begin{cases} (\frac{\partial \varphi}{\partial x}, \frac{\partial \varphi}{\partial y}, \frac{\partial \varphi}{\partial z}) = (-\frac{\sin\varphi}{r\sin \theta}, \frac{\cos\varphi}{r\sin \theta}, 0)\
(\frac{\partial \theta}{\partial x}, \frac{\partial \theta}{\partial y}, \frac{\partial \theta}{\partial z}) = (\frac{\cos \varphi \cos \theta}{r}, \frac{\sin \varphi \cos \theta}{r}, -\frac{\sin \theta}{r}) \end{cases}. \end{aligned} $ Therefore, the gradient of <span>$Y_{\ell}^m$</span> can be expressed as, $ \begin{aligned} \nabla Y<em>{\ell}^m = \frac{\mathrm{i}m P</em>{\ell}^m \mathrm{e}^{\mathrm{i}m\varphi}}{r\sin \theta}\begin{bmatrix} -\sin \varphi \\cos \varphi \0 \end{bmatrix} +  \frac{\partial<em>{\theta}P</em>{\ell}^m \mathrm{e}^{\mathrm{i}m\varphi}}{r}\begin{bmatrix} \cos \varphi \cos \theta\\sin \varphi\cos \theta \-\sin\theta \end{bmatrix}. \end{aligned} $ For the sake of simplicity, we incorporated the coefficient in of <span>$P_{\ell}^m$</span> into the term <span>$P_{\ell}^m$</span> itself.</p><p>To ensure numerically stable evaluation of gradients near <span>$\sin \theta = 0$</span>, we compute <span>$P_{\ell}^m/\sin \theta$</span> instead of <span>$P_{\ell}^m$</span>. We refer to section A.1 of Dusson(2022) for detailed discussion.</p><p>We can further compute <span>$\nabla^2 Y_{\ell}^m$</span> as,  $ \begin{aligned} \nabla^2 Y<em>{\ell m} = \left(\frac{1}{r^2}\frac{\partial}{\partial r} r^2\frac{\partial}{\partial r} - \frac{L^2}{r^2}    \right)Y</em>{\ell}^m = -\frac{\ell(\ell+1)}{r^2}Y_{\ell}^{m}. \end{aligned} $ One can generate a data structure as </p><pre><code class="language-julia hljs">cylm = CYlmBasis(maxL::Integer, T::Type=Float64)</code></pre><p>The complex spherical harmonics allow for </p><pre><code class="language-julia hljs">P = evaluate(basis, X)
P, dP = evaluate_ed(basis, X)</code></pre><p>To retrieve the specific values of <code>Y_l^m</code> and <code>dY_l^m</code> for given indices <code>(l, m)</code>, one can use</p><pre><code class="language-julia hljs">index_y(l,m)</code></pre><h2 id="Alternative-normalizations-conventions"><a class="docs-heading-anchor" href="#Alternative-normalizations-conventions">Alternative normalizations conventions</a><a id="Alternative-normalizations-conventions-1"></a><a class="docs-heading-anchor-permalink" href="#Alternative-normalizations-conventions" title="Permalink"></a></h2><p>Here, we provide a list of alternative normalizations conventions for complex spherical harmonics,</p><ul><li>Schmidt semi-normalized (Racah&#39;s normalization)</li></ul>$<p>\begin{aligned} C<em>{\ell}^m(\theta, \varphi) = \sqrt{\frac{4\pi}{2\ell + 1}}Y</em>{\ell}^m(\theta, \varphi) = \sqrt{\frac{(\ell-m)!}{(\ell+m)!}}P<em>{\ell}^m(\cos \theta)\mathrm{e}^{\mathrm{i}m \varphi},  \end{aligned} $ with  $ \begin{aligned} \int</em>0^{2\pi}\int<em>0^{\pi}C</em>{k}^m(\theta, \varphi)\bar{C}<em>{\ell}^n(\theta, \varphi)\sin \theta \mathrm{d}\theta\mathrm{d}\varphi = \frac{4\pi}{2\ell + 1}\delta</em>{k\ell}\delta<em>{mn}.  \end{aligned} $ In this normalization, C</em>0^0(\theta, \varphi)$ is equal to <span>$1$</span>. </p><ul><li>4π-normalized</li></ul>$<p>\begin{aligned} \mathscr{Y}<em>{\ell}^m (\theta, \varphi) = \sqrt{4\pi}Y</em>{\ell}^m(\theta, \varphi) = \sqrt{(2\ell+1)\frac{(l-m)!}{(l+m)!}}P<em>{\ell}^m(\cos \theta)\mathrm{e}^{\mathrm{i}m \varphi},  \end{aligned} $ with  $ \begin{aligned} \int</em>0^{2\pi}\int<em>0^{\pi}\mathscr{Y}</em>{k}^m(\theta, \varphi)\bar{\mathscr{Y}}<em>{\ell}^n(\theta, \varphi)\sin \theta \mathrm{d}\theta\mathrm{d}\varphi = 4\pi\delta</em>{k\ell}\delta_{mn}.  \end{aligned} $</p><h3 id="Complex-Solid-Harmonics"><a class="docs-heading-anchor" href="#Complex-Solid-Harmonics">Complex Solid Harmonics</a><a id="Complex-Solid-Harmonics-1"></a><a class="docs-heading-anchor-permalink" href="#Complex-Solid-Harmonics" title="Permalink"></a></h3><p>In <code>crlm.jl</code>, Polynomials4ML utilizes orthonormalized complex solid harmonics defined as $ \begin{aligned} 	\gamma<em>{\ell}^m(r, \theta, \varphi) = r^{\ell}Y</em>{\ell}^m(\theta, \varphi).  \end{aligned} $ <span>$\gamma_{\ell}^m$</span>&#39;s are orthogonal is the sense that  $ \begin{aligned} 	\int<em>0^{2\pi}\int</em>0^{\pi}\gamma<em>{k}^m(\theta, \varphi)\bar{\gamma}</em>{\ell}^n(\theta, \varphi)\sin \theta \mathrm{d}\theta\mathrm{d}\varphi =\delta<em>{k\ell}\delta</em>{mn}r^{k+\ell}. \end{aligned} $ The evaluation of solid harmonics can be obtained from the spherical harmonics by a simple scaling with <span>$r^{\ell}$</span>.  To evaluate the gradients of the solid harmonics, <span>$\nabla \gamma_{\ell}^m$</span>, the following expressions are used, $ \begin{aligned} \begin{cases} (\frac{\partial r}{\partial x}, \frac{\partial r}{\partial y}, \frac{\partial r}{\partial z}) = (\sin \theta \cos \varphi,\sin\theta\sin \varphi, \cos \theta)\
(\frac{\partial \varphi}{\partial x}, \frac{\partial \varphi}{\partial y}, \frac{\partial \varphi}{\partial z}) = (-\frac{\sin\varphi}{r\sin \theta}, \frac{\cos\varphi}{r\sin \theta}, 0)\
(\frac{\partial \theta}{\partial x}, \frac{\partial \theta}{\partial y}, \frac{\partial \theta}{\partial z}) = (\frac{\cos \varphi \cos \theta}{r}, \frac{\sin \varphi \cos \theta}{r}, -\frac{\sin \theta}{r}) \end{cases}. \end{aligned} $ Therefore, the gradient of <span>$\gamma_{\ell}^m$</span> can be expressed as, $ \begin{aligned} \nabla \gamma<em>{\ell}^m = \frac{\ell r^{\ell} P</em>{\ell}^m \mathrm{e}^{\mathrm{i}m\varphi}}{r}\begin{bmatrix} \sin \theta \cos \varphi\ \sin\theta\sin \varphi\ \cos \theta \end{bmatrix}+ \frac{\mathrm{i}m P<em>{\ell}^m \mathrm{e}^{\mathrm{i}m\varphi}}{r\sin \theta}\begin{bmatrix} -\sin \varphi \\cos \varphi \0 \end{bmatrix} +  \frac{\partial</em>{\theta}P<em>{\ell}^m \mathrm{e}^{\mathrm{i}m\varphi}}{r}\begin{bmatrix} \cos \varphi \cos \theta\\sin \varphi\cos \theta \-\sin\theta \end{bmatrix}. \end{aligned} $ Similarly, we incorporated the coefficient in of P</em>{\ell}^m$ into the term <span>$P_{\ell}^m$</span> itself. We can further compute <span>$\nabla^2 \gamma_{\ell}^m$</span> as,  $ \begin{aligned} \nabla^2 r^{\ell}Y<em>{\ell m} = \left(\frac{1}{r^2}\frac{\partial}{\partial r} r^2\frac{\partial}{\partial r} - \frac{L^2}{r^2}    \right)r^{\ell}Y</em>{\ell}^m = \frac{Y<em>{\ell m}}{r^2}\frac{\partial}{\partial r}r^2\frac{\partial r^{\ell}}{\partial r} - \frac{r^{\ell}L^2 Y</em>{\ell}^{m}}{r^2} = 0, \end{aligned} $ that is, the solid harmonics are solutions to Laplace&#39;s equation. </p><h3 id="Real-Spherical-Harmonics"><a class="docs-heading-anchor" href="#Real-Spherical-Harmonics">Real Spherical Harmonics</a><a id="Real-Spherical-Harmonics-1"></a><a class="docs-heading-anchor-permalink" href="#Real-Spherical-Harmonics" title="Permalink"></a></h3><p>In <code>rylm.jl</code>, Polynomials4ML utilizes orthonormalized real spherical harmonics that exclude the Condon-Shortley phase. </p><ul><li>Include the Condon-Shortley phase factor:</li></ul>$<p>\begin{aligned} Y<em>{\ell m}(\theta, \varphi) &amp; =  \begin{cases} \frac{\mathrm{i}}{\sqrt{2}}(Y</em>{\ell}^m - (-1)^m Y<em>{\ell}^{-m}) &amp; m &lt; 0\
Y</em>{\ell}^0 &amp; m = 0 \
\frac{1}{\sqrt{2}}(Y<em>{\ell}^{-m} + (-1)^m Y</em>{\ell}^{m}) &amp; m &gt; 0 \end{cases}\
&amp; =  \begin{cases} (-1)^m \bar{P}<em>{\ell}^{|m|}(\cos \theta)\sin(|m|\varphi) &amp; m &lt; 0\
\frac{1}{\sqrt{2}} \bar{P}</em>{\ell}^0(\cos \theta) &amp; m = 0 \
(-1)^m \bar{P}_{\ell}^{m}(\cos \theta)\cos(m\varphi)  &amp; m &gt; 0 \end{cases} \end{aligned} $</p><ul><li>Exclude the Condon-Shortley phase factor:</li></ul>$<p>\begin{aligned} Y<em>{\ell m}(\theta, \varphi) &amp; =  \begin{cases} -\bar{P}</em>{\ell}^{|m|}(\cos \theta)\sin(|m|\varphi) &amp; m &lt; 0\
\frac{1}{\sqrt{2}} \bar{P}<em>{\ell}^0(\cos \theta) &amp; m = 0 \
\bar{P}</em>{\ell}^{m}(\cos \theta)\cos(m\varphi)  &amp; m &gt; 0 \end{cases} \end{aligned} $</p><p>Orthonormalized real spherical harmonics that employ the Condon-Shortley phase up to degree <span>$\ell = 3$</span> are</p><table><tr><th style="text-align: right"><span>$m\backslash\ell$</span></th><th style="text-align: right">0</th><th style="text-align: right">1</th><th style="text-align: right">2</th><th style="text-align: right">3</th></tr><tr><td style="text-align: right">3</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{35}{2\pi}}\cdot \frac{x(x^2-3y^2)}{r^3}$</span></td></tr><tr><td style="text-align: right">2</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{15}{\pi}}\cdot \frac{x^2-y^2}{r^2}$</span></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{105}{\pi}}\cdot \frac{(x^2-y^2)z}{r^3}$</span></td></tr><tr><td style="text-align: right">1</td><td style="text-align: right"></td><td style="text-align: right"><span>$\sqrt{\frac{3}{4\pi}}\cdot \frac{x}{r}$</span></td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{\frac{15}{\pi}}\cdot \frac{zx}{r^2}$</span></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{21}{2\pi}}\cdot \frac{x(5z^2-r^2)}{r^3}$</span></td></tr><tr><td style="text-align: right">0</td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{\frac{1}{\pi}}$</span></td><td style="text-align: right"><span>$\sqrt{\frac{3}{4\pi}}\cdot \frac{z}{r}$</span></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{5}{\pi}}\cdot \frac{3z^2-r^2}{r^2}$</span></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{7}{\pi}}\cdot \frac{z(5z^2-3r^2)}{r^3}$</span></td></tr><tr><td style="text-align: right">-1</td><td style="text-align: right"></td><td style="text-align: right"><span>$\sqrt{\frac{3}{4\pi}}\cdot \frac{y}{r}$</span></td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{\frac{15}{\pi}}\cdot \frac{yz}{r^2}$</span></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{21}{2\pi}}\cdot \frac{y(5z^2-r^2)}{r^3}$</span></td></tr><tr><td style="text-align: right">-2</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{\frac{15}{\pi}}\cdot \frac{xy}{r^2}$</span></td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{\frac{105}{\pi}}\cdot \frac{xyz}{r^2}$</span></td></tr><tr><td style="text-align: right">-3</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><span>$\frac{1}{4}\sqrt{\frac{35}{2\pi}}\cdot \frac{(3x^2-y^2)y}{r^3}$</span></td></tr></table><h3 id="Real-Solid-Harmonics"><a class="docs-heading-anchor" href="#Real-Solid-Harmonics">Real Solid Harmonics</a><a id="Real-Solid-Harmonics-1"></a><a class="docs-heading-anchor-permalink" href="#Real-Solid-Harmonics" title="Permalink"></a></h3><p>In <code>rrlm.jl</code>, Polynomials4ML utilizes Schmidt semi-normalized real solid harmonics that exclude the Condon-Shortley phase.</p><ul><li>Include the Condon-Shortley phase factor:</li></ul>$<p>\begin{aligned} S<em>{\ell m}(r, \theta, \varphi) &amp; =  \begin{cases} \frac{\mathbb{i}}{\sqrt{2}}\left(C</em>{\ell, m}-(-1)^m C<em>{\ell,-m} \right) &amp; m &lt; 0\
C</em>{10} &amp; m = 0 \
 \frac{1}{\sqrt{2}}\left(C<em>{\ell, -m}+(-1)^m C</em>{\ell,m}\right)  &amp; m &gt; 0 \end{cases}\
&amp; = \begin{cases} (-1)^m \sqrt{\frac{4\pi}{2l+1}}\cdot r^{\ell}\bar{P}<em>{\ell}^{|m|}(\cos \theta)\sin(|m|\varphi) &amp; m &lt; 0\
\sqrt{\frac{2\pi}{2l+1}}\bar{P}</em>{\ell}^0(\cos \theta) &amp; m = 0 \
(-1)^m \sqrt{\frac{4\pi}{2l+1}}\cdot r^{\ell}\bar{P}<em>{\ell}^{m}(\cos \theta)\cos(m\varphi)  &amp; m &gt; 0 \end{cases}, \end{aligned} $ where  $ \begin{aligned} C</em>{\ell, m}(r, \theta, \varphi) = \sqrt{\frac{4\pi}{2\ell + 1}}\gamma<em>{\ell}^m(\theta, \varphi),  \end{aligned} $ with  $ \begin{aligned} \int</em>0^{2\pi}\int<em>0^{\pi}C</em>{k,m}(r, \theta, \varphi)\bar{C}<em>{\ell, n}(r, \theta, \varphi)\sin \theta \mathrm{d}\theta\mathrm{d}\varphi = \frac{4\pi}{2\ell + 1}\delta</em>{k\ell}\delta_{mn} r^{k+\ell}.  \end{aligned} $</p><ul><li>Exclude the Condon-Shortley phase factor:</li></ul>$<p>\begin{aligned} S<em>{\ell m}(r, \theta, \varphi)  &amp; =  \begin{cases} -\sqrt{\frac{4\pi}{2l+1}}\cdot r^{\ell}\bar{P}</em>{\ell}^{|m|}(\cos \theta)\sin(|m|\varphi) &amp; m &lt; 0\
\sqrt{\frac{2\pi}{2l+1}}\bar{P}<em>{\ell}^0(\cos \theta) &amp; m = 0 \
\sqrt{\frac{4\pi}{2l+1}}\cdot r^{\ell}\bar{P}</em>{\ell}^{m}(\cos \theta)\cos(m\varphi)  &amp; m &gt; 0 \end{cases} \end{aligned} $</p><p>Schmidt semi-normalized real spherical harmonics that employ the Condon-Shortley phase up to degree <span>$\ell = 3$</span> are</p><table><tr><th style="text-align: right"><span>$m\backslash\ell$</span></th><th style="text-align: right">0</th><th style="text-align: right">1</th><th style="text-align: right">2</th><th style="text-align: right">3</th></tr><tr><td style="text-align: right">3</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{\frac{5}{2}}(x^2-3y^2)x$</span></td></tr><tr><td style="text-align: right">2</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{3}(x^2-y^2)$</span></td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{15}(x^2-y^2)z$</span></td></tr><tr><td style="text-align: right">1</td><td style="text-align: right"></td><td style="text-align: right"><span>$x$</span></td><td style="text-align: right"><span>$\sqrt{3}xz$</span></td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{\frac{3}{2}}(5z^2-r^2)x$</span></td></tr><tr><td style="text-align: right">0</td><td style="text-align: right"><span>$1$</span></td><td style="text-align: right"><span>$z$</span></td><td style="text-align: right"><span>$\frac{1}{2}(3z^2-r^2)$</span></td><td style="text-align: right"><span>$\frac{1}{2}(5z^2-3r^2)z$</span></td></tr><tr><td style="text-align: right">-1</td><td style="text-align: right"></td><td style="text-align: right"><span>$y$</span></td><td style="text-align: right"><span>$\sqrt{3}yz$</span></td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{\frac{3}{2}}(5z^2-r^2)y$</span></td></tr><tr><td style="text-align: right">-2</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><span>$\sqrt{3}xy$</span></td><td style="text-align: right"><span>$\sqrt{15}xyz$</span></td></tr><tr><td style="text-align: right">-3</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><span>$\frac{1}{2}\sqrt{\frac{5}{2}}(3x^2-y^2)y$</span></td></tr></table><p>References:</p><ol><li>Dusson, G., Bachmayr, M., Csányi, G., Drautz, R., Etter, S., van der Oord, C., &amp; Ortner, C. (2022). <a href="https://arxiv.org/pdf/1911.03550.pdf">Atomic cluster expansion: Completeness, efficiency and stability</a>. Journal of Computational Physics, 454, 110946.</li><li>Helgaker, T., Jorgensen, P., &amp; Olsen, J. (2013). <a href="https://www.wiley.com/en-us/Molecular+Electronic-Structure+Theory-p-9780471967552">Molecular electronic-structure theory</a>. John Wiley &amp; Sons.</li><li>Limpanuparb, T., &amp; Milthorpe, J. (2014). <a href="https://arxiv.org/pdf/1410.1748.pdf">Associated Legendre polynomials and spherical harmonics computation for chemistry applications</a>. arXiv preprint arXiv:1410.1748.  </li><li>Wieczorek, M. A., &amp; Meschede, M. (2018). <a href="https://agupubs.onlinelibrary.wiley.com/doi/epdf/10.1029/2018GC007529">SHTools: Tools for working with spherical harmonics.</a> Geochemistry, Geophysics, Geosystems, 19(8), 2574-2592.</li></ol></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 18 July 2023 22:29">Tuesday 18 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
