<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · Polynomials4ML.jl</title><meta name="title" content="API · Polynomials4ML.jl"/><meta property="og:title" content="API · Polynomials4ML.jl"/><meta property="twitter:title" content="API · Polynomials4ML.jl"/><meta name="description" content="Documentation for Polynomials4ML.jl."/><meta property="og:description" content="Documentation for Polynomials4ML.jl."/><meta property="twitter:description" content="Documentation for Polynomials4ML.jl."/><meta property="og:url" content="https://ACEsuit.github.io/Polynomials4ML.jl/api/"/><meta property="twitter:url" content="https://ACEsuit.github.io/Polynomials4ML.jl/api/"/><link rel="canonical" href="https://ACEsuit.github.io/Polynomials4ML.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Polynomials4ML.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#In-place-Evaluation"><span>In-place Evaluation</span></a></li><li><a class="tocitem" href="#Allocating-Evaluation"><span>Allocating Evaluation</span></a></li><li><a class="tocitem" href="#Re-using-Output-Arrays"><span>Re-using Output Arrays</span></a></li><li><a class="tocitem" href="#ChainRules.jl-integration"><span>ChainRules.jl integration</span></a></li><li><a class="tocitem" href="#Lux.jl-Integration"><span>Lux.jl Integration</span></a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/">Tutorial Index</a></li><li><a class="tocitem" href="../literate_tutorials/polyregression/">Linear Regression</a></li></ul></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../SH/">Spherical Harmonics</a></li><li><a class="tocitem" href="../ace/">Cluster Expansion</a></li></ul></li><li><a class="tocitem" href="../docstrings/">Docstrings</a></li><li><a class="tocitem" href="../experimental/">Experimental</a></li><li><span class="tocitem">Developter Documentation</span><ul><li><a class="tocitem" href="../benchmarking/">Benchmark Instructions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ACEsuit/Polynomials4ML.jl/blob/{commit}{path}#{line}" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ACEsuit/Polynomials4ML.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Public-API"><a class="docs-heading-anchor" href="#Public-API">Public API</a><a id="Public-API-1"></a><a class="docs-heading-anchor-permalink" href="#Public-API" title="Permalink"></a></h1><p>This page documents the public API, i.e. the list of bases and functions that are considered relatively stable and for which we aim to strictly impose semver backward compatibility. The basis sets that are considered stable are the following (please see inline documentation for initialization): </p><ul><li>Several classes of orthogonal polynomials <a href="../docstrings/#Polynomials4ML.OrthPolyBasis1D3T"><code>OrthPolyBasis1D3T</code></a><ul><li>General Jacobi <a href="../docstrings/#Polynomials4ML.jacobi_basis-Tuple{Integer, Real, Real}"><code>jacobi_basis</code></a></li><li>Legendre <a href="../docstrings/#Polynomials4ML.legendre_basis-Tuple{Integer}"><code>legendre_basis</code></a></li><li>Chebyshev <a href="../docstrings/#Polynomials4ML.chebyshev_basis-Tuple{Integer}"><code>chebyshev_basis</code></a></li><li>Discrete distribution <a href="../docstrings/#Polynomials4ML.orthpolybasis-Union{Tuple{TW}, Tuple{Integer, Polynomials4ML.DiscreteWeights{TW}}} where TW"><code>orthpolybasis</code></a> </li></ul></li><li>2D harmonics: <ul><li>Complex trigonometric polynomials <a href="../docstrings/#Polynomials4ML.CTrigBasis"><code>CTrigBasis</code></a></li><li>Real trigonometric polynomials <a href="../docstrings/#Polynomials4ML.RTrigBasis"><code>RTrigBasis</code></a></li></ul></li><li>3D harmonics: <ul><li>Complex spherical harmonics <a href="../docstrings/#Polynomials4ML.CYlmBasis"><code>CYlmBasis</code></a></li><li>Real spherical harmonics <a href="../docstrings/#Polynomials4ML.RYlmBasis"><code>RYlmBasis</code></a></li><li>Complex solid harmonics <a href="../docstrings/#Polynomials4ML.CRlmBasis"><code>CRlmBasis</code></a></li><li>Real solid harmonics <a href="../docstrings/#Polynomials4ML.RRlmBasis"><code>RRlmBasis</code></a></li></ul></li><li>Chebyshev polynomials of the first kind <a href="../docstrings/#Polynomials4ML.ChebBasis"><code>ChebBasis</code></a></li><li>Cluster Expansion: <ul><li>Fused tensor produce and pooling <a href="../docstrings/#Polynomials4ML.PooledSparseProduct"><code>PooledSparseProduct</code></a></li><li>Sparse symmetric product <a href="../docstrings/#Polynomials4ML.SparseSymmProd"><code>SparseSymmProd</code></a></li><li>Alternative sparse symmetric product implementation <a href="../docstrings/#Polynomials4ML.SparseSymmProdDAG"><code>SparseSymmProdDAG</code></a> </li></ul></li><li>LinearLayer <a href="../docstrings/#Polynomials4ML.LinearLayer"><code>LinearLayer</code></a></li><li>Various quantum chemistry related radial basis functions. (experimental)</li></ul><h2 id="In-place-Evaluation"><a class="docs-heading-anchor" href="#In-place-Evaluation">In-place Evaluation</a><a id="In-place-Evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#In-place-Evaluation" title="Permalink"></a></h2><p>This section documents the in-place evaluation interface. The polynomial basis sets implemented in this package should provide this interface as a minimal requirement. The cluster expansion features do not implement these at present. </p><pre><code class="language-julia hljs">evaluate!(P, basis, X)
evaluate_ed!(P, dP, basis, X)
evaluate_ed2!(P, dP, ddP, basis, X)</code></pre><ul><li><code>basis</code> : an object defining one of the basis sets </li><li><code>X</code> : a single input or array of inputs. </li><li><code>P</code> : array containing the basis values </li><li><code>dP</code> : array containing derivatives of basis w.r.t. inputs </li><li><code>ddP</code> : array containing second derivatives of basis w.r.t. inputs </li></ul><p>If <code>X</code> is a single input then this should normally be a <code>Number</code> or a <code>StaticArray</code> to distinguish it from collections of inputs. <code>X</code> can also be an <code>AbstractArray</code> of admissible inputs, e.g., <code>Vector{&lt;: Number}</code>. </p><p>If <code>X</code> is a single input then <code>P</code>, <code>dP</code>, <code>ddP</code> will be <code>AbstractVector</code>. If <code>X</code> is an <code>AbstractVector</code> of inputs then <code>P</code>, <code>dP</code>, <code>ddP</code> must be <code>AbstractMatrix</code>, and so forth. </p><p>The output arrays <code>P</code>, <code>dP</code>, <code>ddP</code> must be sufficiently large in each dimension to accomodate the size of the input and the size of the basis, but the sizes need not match exactly. It is up to the caller to ensure matching array sizes if this is needed.</p><h2 id="Allocating-Evaluation"><a class="docs-heading-anchor" href="#Allocating-Evaluation">Allocating Evaluation</a><a id="Allocating-Evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Allocating-Evaluation" title="Permalink"></a></h2><p>This section documents the allocating evaluation interface. All basis sets should implement this interface.</p><pre><code class="language-julia hljs">P = evaluate(basis, X)
P, dP = evaluate_ed(basis, X)
P, dP, ddP = evaluate_ed2(basis, X)</code></pre><p>The output types of <code>P, dP, ddP</code> are guaranteed to be <code>AbstractArray</code>s but may otherwise change between package versions. The exact type should not be relied upon when using this package.</p><p>The meaning of the different symbols is exactly the same as described above. The only difference is that the output containers <code>P</code>, <code>dP</code>, <code>ddP</code> are now allocated.  Their type should be stable (if not, please file a bug report), but unspecified in the sense that the output type is not semver-stable for the time being.  If you need a sem-ver stable output then it is best to follow the above with a <code>collect</code>.</p><h2 id="Re-using-Output-Arrays"><a class="docs-heading-anchor" href="#Re-using-Output-Arrays">Re-using Output Arrays</a><a id="Re-using-Output-Arrays-1"></a><a class="docs-heading-anchor-permalink" href="#Re-using-Output-Arrays" title="Permalink"></a></h2><p>For many models / bases, pullbacks, etc, the default output arrays are of type <code>CachedArray</code>.  This means that after they have been used, they can be released back into an array cache from which they have been acquired. (See <code>ObjectPools.jl</code> for more details.) This will avoid a new allocation next time a basis is evaluated. The interface for this is </p><pre><code class="language-julia hljs">B = evaluate(basis, X)
release!(B)
B, dB = evaluate_ed(basis, X)
release!(B)
release!(dB)
# ... and so forth ... </code></pre><p>The <code>release!</code> function can still be applied to output arrays that are not a <code>CachedArray</code>, this will then simply be a no-op. </p><div class="admonition is-danger"><header class="admonition-header">Usage of `CachedArray` outputs</header><div class="admonition-body"><p><code>CachedArray</code>s can cause type instabilities when used in unexpected ways. To prevent this, if <code>B::CachedArray</code> is an output from a basis (or similar) simply use its unwrapped <code>PtrArray</code> instead by calling <code>unwrap(B)</code> in <code>ObjectPools.jl</code>. This will extract the internally stored array, normally a core Julia <code>Array</code> or a <code>PtrArray</code> from the package <code>StrideArrays.jl</code>. </p></div></div><h2 id="ChainRules.jl-integration"><a class="docs-heading-anchor" href="#ChainRules.jl-integration">ChainRules.jl integration</a><a id="ChainRules.jl-integration-1"></a><a class="docs-heading-anchor-permalink" href="#ChainRules.jl-integration" title="Permalink"></a></h2><p>We aim to provide <code>ChainRules.jl</code> integration for all model components. At present, we have focused on providing the <code>rrule</code> interface. If <code>basis</code> is a polynomial basis (or other model component) then one can obtain its value and pullback via the <code>ChainRules.jl</code> interface, </p><pre><code class="language-julia hljs">B, pb = rrule(evaluate, basis, X)</code></pre><p>Internally, the pullback <code>pb</code> will most likely call a custom implementation of the pullback operation. Where possible we also implement pullbacks over pullbacks to enable second-order backward differentiation. This is needed when minimizing a loss function that involves a model derivative.</p><p>If any <code>rrule</code>s are missing or not working as expected, please file an issue. </p><h2 id="Lux.jl-Integration"><a class="docs-heading-anchor" href="#Lux.jl-Integration">Lux.jl Integration</a><a id="Lux.jl-Integration-1"></a><a class="docs-heading-anchor-permalink" href="#Lux.jl-Integration" title="Permalink"></a></h2><p>Although all bases and models components that we implement here can be used &quot;as is&quot;, we also aim to provide wrappers that turn them into <code>Lux.jl</code> layers. For any basis or model component <code>basis</code>, one can simply call </p><pre><code class="language-julia hljs">l_basis = lux(basis)</code></pre><p>The resulting object <code>l_basis</code> can then be used to construct networks using the <code>Lux.jl</code> package. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../tutorials/">Tutorial Index »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Thursday 23 November 2023 22:54">Thursday 23 November 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
